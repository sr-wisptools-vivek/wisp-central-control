<template name="wtBraintreeEditCustomer">
  <div class="bg-secondary app-page">
    <div class="container">
      {{#if customer}}
      {{#with customer}}
      <h3>{{ showTitle }} <span class="pull-right">{{ customerId }}</span></h3><hr />
      <div class="row">
        <form class="form-horizontal col-md-8">
          <div class="form-group">
            <label for="firstname" class="col-sm-3 control-label">First Name</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="firstName" fieldValue=firstName fieldPlaceholder="First Name" }}
            </div>
          </div>
          <div class="form-group">
            <label for="lastname" class="col-sm-3 control-label">Last Name</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="lastName" fieldValue=lastName fieldPlaceholder="Last Name" }}
            </div>
          </div>
          <div class="form-group">
            <label for="companyname" class="col-sm-3 control-label">Company Name</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="company" fieldValue=company fieldPlaceholder="Company Name" }}
            </div>
          </div>
          <div class="form-group">
            <label for="phone" class="col-sm-3 control-label">Phone</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="phone" fieldValue=phone fieldPlaceholder="Phone" }}
            </div>
          </div>
          <div class="form-group">
            <label for="email" class="col-sm-3 control-label">Email</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="email" fieldValue=email fieldPlaceholder="Email" }}
            </div>
          </div>
          <div class="form-group">
            <label for="address" class="col-sm-3 control-label">Address</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="address" fieldValue=address fieldPlaceholder="Address" }}
            </div>
          </div>
          <div class="form-group">
            <label for="city" class="col-sm-3 control-label">City</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="city" fieldValue=city fieldPlaceholder="City" }}
            </div>
          </div>
          <div class="form-group">
            <label for="state" class="col-sm-3 control-label">State</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="state" fieldValue=state fieldPlaceholder="State" }}
            </div>
          </div>
          <div class="form-group">
            <label for="zip" class="col-sm-3 control-label">Zip</label>
            <div class="col-sm-6">
              {{ > wtBraintreeClickToEdit fieldName="zip" fieldValue=zip fieldPlaceholder="Zip" }}
            </div>
          </div>
        </form>
      </div>
      {{/with}}
      {{else}}
      <div class="row">
        <div class="alert alert-danger" role="alert">
          Customer not found.
        </div>
      </div>
      {{/if}}
      <h4>Payment Methods</h4>
      <div class="row">
      {{#if showPaymentAddForm}}
        {{ > wtBraintreeAddPaymentMethodForm }}
      {{else}}
        <button class="btn btn-success addCreditCardBtn pull-right">Add Credit Card</button><br><br>
      {{/if}}
      </div>
      <div class="row">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Type</th>
              <th>Name</th>
              <th>Number</th>
              <th>Expiry</th>
              <th>Subscriptions</th>
              <th colspan="2">Actions</th>
            </tr>
          </thead>
          <tbody>
            {{#if paymentmethods}}
            {{#each paymentmethods}}
            <tr class="{{#if isEdit}}warning{{/if}}">
              <td>{{cardType}}</td>
              <td>{{cardholderName}}</td>
              <td>{{maskedNumber}}</td>
              <td>{{expirationDate}}</td>
              <td>{{subscriptionscount}}</td>
              <td>
                <form class="form-inline">
                  <div class="form-group">
                    <select class="form-control">
                      {{#each plans}}
                      <option value="{{id}}">{{name}}</option>
                      {{/each}}
                    </select>
                  </div>
                  <button type="submit" class="btn btn-default createSubscriptionBtn">Create Subscription</button>
                </form>
              </td>
              <td>
                {{#if isEdit}}
                <button class="btn btn-warning cancelEditPaymentMethod">Cancel</button>
                {{else}}
                <button class="btn btn-primary editPaymentMethod">Edit</button>
                {{/if}}
              </td>
            </tr>
            {{/each}}
            {{else}}
            <tr>
              <td colspan="6">No Payment Methods</td>
            </tr>
            {{/if}}
          </tbody>
        </table>
      </div>
      {{#if showPaymentEditForm}}
      <div class="row">
        {{ > wtBraintreeEditPaymentMethodForm }}
      </div>
      {{/if}}
      <h4>Subscriptions</h4>
      <div class="row">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Plan</th>
              <th>Price</th>
              <th>Billing Period</th>
              <th>Balance</th>
              <th>Next Bill Amount</th>
              <th>Next Billing Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {{#if subscriptions}}
            {{#each subscriptions}}
            <tr>
              <td>{{planName planId}}</td>
              <td>{{price}}</td>
              <td>{{billingPeriodStartDate}} to {{billingPeriodEndDate}}</td>
              <td>{{balance}}</td>
              <td>{{nextBillAmount}}</td>
              <td>{{nextBillingDate}}</td>
              <td>{{status}}</td>
              <td>
                {{#if isActive}}
                <button class="btn btn-danger cancelSubscription">Cancel</button>
                {{/if}}
              </td>
            </tr>
            {{/each}}
            {{else}}
            <tr>
              <td colspan="7">No Subscriptions</td>
            </tr>
            {{/if}}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</template>

<template name="wtBraintreeClickToEdit">
  <div class="click-to-edit-area">
    {{#if isEditing fieldName}}
      <input type="text" class="form-control" id="{{ fieldName }}" placeholder="{{ fieldPlaceholder }}" value="{{ fieldValue }}">
    {{else}}
      <p class="form-control-static editable">
        {{ fieldValue }} &nbsp;
        {{> wtEditableIcon}}
      </p>
    {{/if}}
  </div>
</template>
